<!DOCTYPE html>
<html lang="en" xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://developers.facebook.com/schema/" class="ba">
  <head>
    <title>System OSAX</title>
    <link rel="canonical" href="http://totalfinder.binaryage.com/system-osax"/>
    <link rel="shortcut icon" href="http://static.binaryage.com/5604bda0_favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="http://static.binaryage.com/5604bda0_favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="http://static.binaryage.com/b39cd94e_shared_css_site.css" type="text/css"/>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="N_xzdr6ymSUQFhAEvQg7f-sp1JAeJCdW2JuaRg-da0w"/>
    <meta property="fb:admins" content="antonin.hildebrand"/>
    <link href="http://feeds.feedburner.com/binaryage-blog" type="application/atom+xml" rel="alternate" title="Ideas from BinaryAge"/>
    <script type="text/javascript" charset="utf-8">function parseUri(r){var e=parseUri.options,o=e.parser[e.strictMode?"strict":"loose"].exec(r),s={},t=14;while(t--)s[e.key[t]]=o[t]||"";s[e.q.name]={};s[e.key[12]].replace(e.q.parser,function(r,o,t){if(o)s[e.q.name][o]=t});return s}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}}</script>
    <script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
    <script>WebFont.load({google:{families:["Play:400,700:latin"]}})</script>
    <script src="http://static.binaryage.com/3e4de0bb_shared_js_code.js"></script>
    <script type="text/javascript">window["ga"]=function(){}</script>
    <script>window["ga"]=undefined;(function(e,n,a,t,i,o,r){e["GoogleAnalyticsObject"]=i;e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date;o=n.createElement(a),r=n.getElementsByTagName(a)[0];o.async=1;o.src=t;r.parentNode.insertBefore(o,r)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-8404259-1","auto",{allowLinker:true});ga("send","pageview");ga("require","linker");ga("linker:autoLink",["fastspring.com"],true)</script>
  </head>
  <body id="page-totalfinder-system-osax">
    <div id="header">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="relativize">
              <a href="http://www.binaryage.com" title="BinaryAge Software">
                <div class="binaryage-logo">
                  <svg class="logo">
                    <g class="logo-badge">
                      <rect class="logo-badge-background" x="0" y="0" rx="4" ry="4" width="60" height="54"/>
                      <path class="logo-letter-b" d=" M6,47 L6,17 12,17 12,25 29,25 29,47 Z M12,42 L12,30 23,30 23,42 Z"/>
                      <path class="logo-letter-a" d=" M32,47 L32,34 49,34 49,30 32,30 32,25 54,25 54,47 Z M37,42 L37,39 49,39 49,42 Z"/>
                    </g>
                    <g class="logo-label" transform="translate(71, 22)">
                      <g class="logo-word-binary">
                        <path class="logo-label-letter-b" transform="translate(0, 0)" d=" M0,25 L0,0 5,0 5,7 20,7 20,25 Z M5,21 L5,11 15,11 15,21 Z"/>
                        <path class="logo-label-letter-i" transform="translate(22, 0)" d=" M0,25 L0,7 5,7 5,25 Z M0,3 L5,3 5,0 0,0 Z"/>
                        <path class="logo-label-letter-n" transform="translate(29, 0)" d=" M0,25 L0,7 20,7 20,25 15,25 15,11 5,11 5,25 Z"/>
                        <path class="logo-label-letter-a" transform="translate(51, 0)" d=" M0,25 L0,14 15,14 15,11 0,11 0,7 20,7 20,25 Z M5,21 L5,18 15,18 15,21 Z"/>
                        <path class="logo-label-letter-r" transform="translate(73, 0)" d=" M0,25 L0,7 20,7 20,11 5,11 5,25 Z"/>
                        <path class="logo-label-letter-y" transform="translate(95, 0)" d=" M0,25 L0,7 5,7 5,21 15,21 15,7 20,7 20,32 0,32 0,28 15,28 15,25 Z"/>
                      </g>
                      <g class="logo-word-age" transform="translate(118, 0)">
                        <path class="logo-label-letter-a" transform="translate(0, 0)" d=" M0,25 L0,14 15,14 15,11 0,11 0,7 20,7 20,25 Z M5,21 L5,18 15,18 15,21 Z"/>
                        <path class="logo-label-letter-g" transform="translate(22, 0)" d=" M0,25 L0,7 20,7 20,32 0,32 0,28 15,28 15,25 Z M5,21 L5,11 15,11 15,21 Z"/>
                        <path class="logo-label-letter-e" transform="translate(44, 0)" d=" M0,25 L0,7 20,7 20,18 5,18 5,21 20,21 20,25 Z M5,14 L5,11 15,11 15,14 Z"/>
                      </g>
                    </g>
                  </svg>
                </div>
              </a>
            </div>
            <div class="relativize">
              <ul class="header-menu menu-selected-">
                <li class="menu-item-store"><a href="http://www.binaryage.com/store"><i class="fa fa-shopping-cart"></i><span>store</span></a></li>
                <li class="menu-item-products"><a href="http://www.binaryage.com"><i class="fa fa-star"></i><span>products</span></a></li>
                <li class="menu-item-blog"><a href="http://blog.binaryage.com"><i class="fa fa-bullhorn"></i><span>blog</span></a></li>
                <li class="menu-item-support"><a href="http://discuss.binaryage.com"><i class="fa fa-comments"></i><span>support</span></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="main" class="cf">
      <div class="doc-content">
        <div class="container">
          <div class="row">
            <div class="col-md-3">
              <div class="sidebar">
                <div class="header-sidebar">
                  <a class="back-button" href="/">Â« Back to Homepage</a>
                </div>
                <div class="content-sidebar">
                  <h2>Change log</h2>
                  <ul class="fa-ul">
                    <li><a href="/changes" data-alt="/beta-changes">Recent changes</a></li>
                  </ul>
                  <h2>Before installing</h2>
                  <ul class="fa-ul">
                    <li><a href="/about">About TotalFinder</a></li>
                    <li><a href="/installation">Installation</a></li>
                    <li><a href="/uninstallation">Uninstallation</a></li>
                    <li><a href="/licensing">Licensing</a></li>
                    <li><a href="/purchasing">Purchasing</a></li>
                    <li><a href="/registration">Registration</a></li>
                  </ul>
                  <h2>Features</h2>
                  <ul class="fa-ul">
                    <li><a href="/tabs">Tabs</a></li>
                    <li><a href="/dual-mode">Dual mode</a></li>
                    <li><a href="/folders-on-top">Folders on top</a></li>
                    <li><a href="/show-system-files">Show system files</a></li>
                    <li><a href="/colored-labels">Colored Labels</a></li>
                    <li><a href="/tweaks">Other Tweaks</a></li>
                  </ul>
                  <h2>More</h2>
                  <ul class="fa-ul">
                    <li><a href="/compatibility">Compatibility</a></li>
                    <li><a href="/system-integrity-protection">System Integrity Protection</a></li>
                    <li><a href="/reasons-to-buy">Reasons to buy</a></li>
                    <li><a href="/free-licenses">Free licenses</a></li>
                    <li><a href="/credits">Credits</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-md-9">
              <div class="doc-page">
                <div class="header-content">
                  <h1 class="title">TotalFinder with System Integrity Protection fully enabled</h1>
                </div>
                <div class="generic-separator"></div>
                <div class="page-content">
                  <p>Under OS X 10.11 (El Capitan) and macOS 10.12 (Sierra), TotalFinder cannot install itself on a normally configured machine due to <a href="https://en.wikipedia.org/wiki/System_Integrity_Protection">System Integrity Protection</a>.</p>
                  <p><a href="/system-integrity-protection">This article describes how to partially disable System Integrity Protection</a> to install and run TotalFinder under El Capitan and higher.</p>
                  <h2>What if I need to keep SIP fully enabled?</h2>
                  <p>There is a way, but it has some major drawbacks. This article is for technical users who need to run TotalFinder with fully enabled SIP.</p>
                  <p>This technique does not require you to disable SIP, but it requires you to modify system files in Recovery OS.</p>
                  <ol>
                    <li>It requires technical knowledge how to mount file-systems and manipulate files using command-line.</li>
                    <li>With any TotalFinder update. You will have to repeat this installation.</li>
                    <li>With any system update, TotalFinder files are likely to be removed from system folders. You would have to repeat this installation.</li>
                  </ol>
                  <h2>Technical details</h2>
                  <p>TotalFinder needs to inject code into Finder.app. It uses mechanism called <a href="https://developer.apple.com/library/mac/technotes/tn1164">Scripting additions</a>. Scripting addition is a special code bundle which can be injected into running applications.</p>
                  <p>Scripting additions have 'osax' file extension. Historically there are three places where scripting addtions can be placed:</p>
                  <ol>
                    <li><code>~/Library/ScriptingAdditions</code></li>
                    <li><code>/Library/ScriptingAdditions</code></li>
                    <li><code>/System/Library/ScriptingAdditions</code></li>
                  </ol>
                  <p>The original idea was to keep user-specific additions in the first location, system-wide admin-installed additions in the second one and Apple's own system additions in the third location.
                    There are various restrictions on what is considered a <em>valid</em> OSAX and those restrictions evolved over successive OS versions.
                  After El Capitan, scripting additions placed in <code>/Library/ScriptingAdditions</code> are no longer allowed to inject into system processes (processes with Apple's code signature) due to System Integrity Protection.</p>
                  <p>However it is possible to put an addition into <code>/System/Library/ScriptingAdditions</code> and it can then freely inject into system processes.
                    This technique was <a href="https://github.com/norio-nomura/EasySIMBL/issues/26#issuecomment-117028426">discovered and described by SIMBL developers</a>.
                  The problem is that <code>/System/Library/ScriptingAdditions</code> is a system folder protected by SIP. You can manipulate it only with SIP fully disabled or from within Recovery OS.</p>
                  <p>By default TotalFinder installs its scripting addition into <code>/Library/ScriptingAddtions</code>. Then you can manually move it to <code>/System/Library/ScriptingAdditions</code>. TotalFinder is aware of this setup since <a href="http://totalfinder.binaryage.com/beta-changes#1.7.10">version 1.7.10</a>.</p>
                  <p>But you should be aware of the drawbacks:</p>
                  <ol>
                    <li><code>/System/Library/ScriptingAdditions</code> is owned by Apple, any system update can decide to remove non-Apple files from there.</li>
                    <li><code>/System/Library/ScriptingAdditions</code> is under SIP protection, that means that TotalFinder update cannot modify TotalFinder.osax located there. TotalFinder update will place TotalFinder.osax as usual into <code>/Library/ScriptingAddtions</code> and you have to be aware of it and go into Recovery OS and move it again.</li>
                  </ol>
                  <h3>Installation steps</h3>
                  <ol>
                    <li>Install TotalFinder (or update TotalFinder)</li>
                    <li>Reboot into <a href="https://support.apple.com/en-us/HT201314">Recovery OS</a></li>
                    <li>Open Terminal from Utilities menu</li>
                    <li>Mount your main system disk - this depends on your setup, see explanation below</li>
                    <li>Move TotalFinder.osax from <code>/Library/ScriptingAdditions</code> to <code>/System/Library/ScriptingAdditions</code> on your system disk</li>
                    <li>Fix rights on newly moved folder</li>
                  </ol>
                  <h3>STEP 4: mount your main system disk</h3>
                  <p>This can get more complicated depending on your setup. If you don't use FileVault, you can use <code>Disk Utility</code> to mount your main system disk using GUI.
                  Or use <code>diskutil mount</code> from command-line. In case of FileVault you have to use <code>disktutil corestorage unlockVolume</code> command.</p>
                  <p>In either case you should end up with your main system disk mounted at <code>/Volumes/[NAME]</code> where <code>[NAME]</code> is some name you gave to your disk during formatting (potentially includes spaces).</p>
                  <h3>STEPS 5-6: move and fix rights</h3>
                  <p>My system disk was mounted as <code>/Volumes/Capitan</code>, here are commands relevant to my situation:</p>
                  <pre><code>cd "/Volumes/Capitan/System/Library/ScriptingAdditions"
mv "../../../Library/ScriptingAdditions/TotalFinder.osax" .
chown -R root:wheel TotalFinder.osax
</code></pre>
                  <h2>Final words</h2>
                  <p>As you can see. It is not that difficult if you know what you are doing. The main problem are TotalFinder and system updates. You have to repeat this installation over and over again.</p>
                  <h3>A note on uninstallation</h3>
                  <p>Again you have to go into Recovery OS, mount your main system disk and remove TotalFinder.osax from <code>/System/Library/ScriptingAdditions</code>. My uninstaller cannot do that because it is a SIP-protected location.</p>
                  <pre><code>cd "/Volumes/Capitan/System/Library/ScriptingAdditions"
rm -rf TotalFinder.osax
</code></pre>
                  <script>$(function(){$(".doc-image").wrap(function(){return $("<a class='wrapped-doc-image' data-fancybox-group='doc'></div>").attr("href",$(this).attr("src")).attr("title",$(this).attr("title"))});$(".wrapped-doc-image").fancybox()})</script>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script>$(function(){setTimeout(function(){var a=document.location.pathname+"";var e=$('.sidebar a[href*="'+a+'"]');e.parent().addClass("selected");var e=$('.sidebar a[data-alt*="'+a+'"]');e.parent().addClass("selected")},100)})</script>
    <p></div></p>
    <div id="footer">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
          </div>
          <div class="col-md-4">
            <div class="footer-box-right">
              <div class="footer-copyright">
                <div class="footer-license">
                  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0"><img title="the website license" alt="Creative Commons License" style="border-width:0" src="http://static.binaryage.com/69a4ba35_shared_img_byccnd.png"/></a>
                </div>
                <a href="http://www.binaryage.com/about">BinaryAge Limited</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript" charset="utf-8">if(window.jQuery){$(function(){setTimeout(function(){var i=location.hash.substring(1);if(i.substring(0,2)=="o-"){$("#"+i).trigger("click")}},500)})}</script>
    <script type="text/javascript">var _gauges=_gauges||[];(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.id="gauges-tracker";e.setAttribute("data-site-id","4f10d65d844d52139500000b");e.src="//secure.gaug.es/track.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()</script>
  </body>
</html>